/**
 * ğŸ® useListMenu = åˆ—è¡¨é¸å–®é™æ§å™¨ (åˆ—è¡¨é¸å–®å°ˆç”¨ Composable)
 * 
 * ğŸ¯ é€™å€‹æª”æ¡ˆè² è²¬ä»€éº¼ï¼Ÿ
 * - å°è£åˆ—è¡¨é¸å–®çš„é–‹é—œç‹€æ…‹ç®¡ç†
 * - æä¾›é¸å–®æ“ä½œçš„çµ±ä¸€ä»‹é¢
 * - å¯¦ç¾ä¾è³´åè½‰ï¼Œè®“çµ„ä»¶ä¸ç›´æ¥ä¾è³´ boardStore
 * - éµå¾ªå–®ä¸€è·è²¬åŸå‰‡ï¼Œå°ˆé–€è™•ç†é¸å–®ç›¸é—œé‚è¼¯
 * 
 * ğŸ¤” æƒ³åƒä½ æœ‰ä¸€å€‹é¸å–®é™æ§å™¨ï¼š
 * 
 * âŒ æ²’æœ‰é™æ§å™¨çš„ä¸–ç•Œï¼š
 * - çµ„ä»¶è¦ç›´æ¥ä¼¸æ‰‹é€² boardStore æ©Ÿå™¨è£¡æ§åˆ¶é¸å–®
 * - æ¯å€‹çµ„ä»¶éƒ½è¦çŸ¥é“æ©Ÿå™¨å…§éƒ¨çµæ§‹
 * - æ©Ÿå™¨æ”¹äº†ï¼Œæ‰€æœ‰çµ„ä»¶éƒ½è¦ä¿®ç†
 * 
 * âœ… æœ‰é™æ§å™¨çš„ä¸–ç•Œï¼š
 * - æŒ‰ã€Œé–‹å•Ÿé¸å–®ã€æŒ‰éˆ•å°±èƒ½é–‹å•Ÿ
 * - æŒ‰ã€Œé—œé–‰é¸å–®ã€æŒ‰éˆ•å°±èƒ½é—œé–‰
 * - çµ„ä»¶ä¸ç”¨çŸ¥é“æ©Ÿå™¨æ€éº¼é‹ä½œï¼ŒæŒ‰æŒ‰éˆ•å°±å°äº†
 * 
 * ğŸ“‹ ä¸»è¦åŠŸèƒ½ï¼š
 * 1. openMenuId - å–å¾—ç›®å‰é–‹å•Ÿçš„é¸å–® ID
 * 2. toggleMenu() - åˆ‡æ›æŒ‡å®šé¸å–®çš„é–‹é—œç‹€æ…‹
 * 3. closeAllMenus() - é—œé–‰æ‰€æœ‰é¸å–®
 * 
 * ğŸ”„ æ¶æ§‹æ¨¡å¼ï¼š
 * ListMenu â†’ useListMenu â†’ boardStore
 * (UIå±¤)  â†’  (æ¥­å‹™é‚è¼¯å±¤) â†’ (è³‡æ–™å±¤)
 * 
 * ğŸ’¡ è¨­è¨ˆåŸå‰‡æ‡‰ç”¨ï¼š
 * - D (Dependency Inversion): çµ„ä»¶ä¾è³´æŠ½è±¡ï¼Œä¸ä¾è³´å…·é«”å¯¦ä½œ
 * - S (Single Responsibility): åªè² è²¬é¸å–®ç‹€æ…‹ç®¡ç†
 * - O (Open/Closed): å°æ“´å±•é–‹æ”¾ï¼Œå°ä¿®æ”¹å°é–‰
 * 
 * ğŸ¯ é€™å€‹æª”æ¡ˆå°±æ˜¯ã€Œé¸å–®æ“ä½œçš„é™æ§å™¨ã€ï¼š
 * - çµ„ä»¶æƒ³çŸ¥é“é¸å–®é–‹è‘—å—ï¼Ÿçœ‹ openMenuId
 * - çµ„ä»¶æƒ³é–‹é—œé¸å–®ï¼ŸæŒ‰ toggleMenu() æŒ‰éˆ•
 * - çµ„ä»¶æƒ³é—œé–‰æ‰€æœ‰é¸å–®ï¼ŸæŒ‰ closeAllMenus() æŒ‰éˆ•
 * - åº•å±¤æ€éº¼å­˜æ”¾è³‡æ–™ï¼Ÿçµ„ä»¶ä¸ç”¨çŸ¥é“
 */

import { storeToRefs } from 'pinia'
import { useBoardStore } from '@/stores/boardStore'

// å°è£åˆ—è¡¨é¸å–®çš„é–‹é—œç‹€æ…‹èˆ‡æ“ä½œï¼Œé¿å…å…ƒä»¶ç›´æ¥ä¾è³´ boardStoreï¼ˆä¾è³´åè½‰ï¼‰
export const useListMenu = () => {
  const store = useBoardStore()
  
  // ğŸ”— ä½¿ç”¨ storeToRefs è®“ reactive è³‡æ–™ä¿æŒéŸ¿æ‡‰æ€§
  // é€™æ¨£çµ„ä»¶å°±èƒ½è‡ªå‹•éŸ¿æ‡‰é¸å–®ç‹€æ…‹çš„è®ŠåŒ–
  const { openMenuId } = storeToRefs(store)
  
  // åˆ‡æ›æŒ‡å®šé¸å–®çš„é–‹å•Ÿç‹€æ…‹
  // å¦‚æœè©²é¸å–®å·²é–‹å•Ÿå‰‡é—œé–‰ï¼Œå¦‚æœå…¶ä»–é¸å–®é–‹å•Ÿå‰‡åˆ‡æ›åˆ°è©²é¸å–®
  const toggleMenu = (listId: string) => {
    console.log('ğŸ® [COMPOSABLE] toggleMenu è¢«å‘¼å«ï¼Œåˆ—è¡¨ID:', listId)
    store.toggleMenu(listId)
  }
  
  // é—œé–‰æ‰€æœ‰é¸å–®
  // é€šå¸¸åœ¨é»æ“Šå¤–éƒ¨å€åŸŸæˆ–åŸ·è¡Œæ“ä½œå¾Œå‘¼å«
  const closeAllMenus = () => {
    console.log('ğŸ® [COMPOSABLE] closeAllMenus è¢«å‘¼å«')
    store.closeAllMenus()
  }
  
  // å›å‚³çµ±ä¸€çš„ä»‹é¢ï¼Œè®“çµ„ä»¶åªéœ€è¦çŸ¥é“é€™äº›æ–¹æ³•
  return { 
    openMenuId,    // éŸ¿æ‡‰å¼çš„é–‹å•Ÿé¸å–® ID
    toggleMenu,    // åˆ‡æ›é¸å–®æ–¹æ³•
    closeAllMenus  // é—œé–‰æ‰€æœ‰é¸å–®æ–¹æ³•
  }
}